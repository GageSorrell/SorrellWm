"use strict";
exports.id = "Source_Main_MainWindow_ts";
exports.ids = ["Source_Main_MainWindow_ts"];
exports.modules = {

/***/ "./Source/Main/MainWindow.ts":
/*!***********************************!*\
  !*** ./Source/Main/MainWindow.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! path */ "path");
/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sorrellwm/windows */ "./Windows/index.js");
/* harmony import */ var _sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var electron__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! electron */ "electron");
/* harmony import */ var electron__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(electron__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Keyboard__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Keyboard */ "./Source/Main/Keyboard.ts");
/* harmony import */ var _Core_Utility__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Core/Utility */ "./Source/Main/Core/Utility.ts");
/* harmony import */ var _Domain_Common_Component_Keyboard_Keyboard__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/Domain/Common/Component/Keyboard/Keyboard */ "./Source/Renderer/Domain/Common/Component/Keyboard/Keyboard.ts");
/* harmony import */ var _Tree__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Tree */ "./Source/Main/Tree.ts");
/* harmony import */ var chalk__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! chalk */ "./node_modules/chalk/source/index.js");
/* harmony import */ var chalk__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(chalk__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _Development__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Development */ "./Source/Main/Development/index.ts");
/* File:    MainWindow.ts
 * Author:  Gage Sorrell <gage@sorrell.sh>
 * License: MIT
 */









let MainWindow = undefined;
const GetLeastInvisiblePosition = () => {
    const Displays = electron__WEBPACK_IMPORTED_MODULE_2__.screen.getAllDisplays();
    const MonitorBounds = Displays.map((display) => {
        return {
            bottom: display.bounds.y + display.bounds.height,
            left: display.bounds.x,
            right: display.bounds.x + display.bounds.width,
            top: display.bounds.y
        };
    });
    MonitorBounds.sort((A, B) => A.left - B.left || A.top - B.top);
    const MaxRight = Math.max(...MonitorBounds.map((bounds) => bounds.right));
    const MaxBottom = Math.max(...MonitorBounds.map((bounds) => bounds.bottom));
    const InvisibleX = (MaxRight + 1) * 2;
    const InvisibleY = (MaxBottom + 1) * 2;
    return {
        x: InvisibleX,
        y: InvisibleY
    };
};
const LaunchMainWindow = async () => {
    console.log("Launching main window.");
    MainWindow = new electron__WEBPACK_IMPORTED_MODULE_2__.BrowserWindow({
        alwaysOnTop: true,
        frame: false,
        height: 900,
        show: true,
        skipTaskbar: true,
        title: "SorrellWm Main Window",
        titleBarStyle: "hidden",
        transparent: true,
        webPreferences: {
            devTools: false,
            // devTools: true,
            nodeIntegration: true,
            preload: electron__WEBPACK_IMPORTED_MODULE_2__.app.isPackaged
                ? path__WEBPACK_IMPORTED_MODULE_0__.join(__dirname, "Preload.js")
                : path__WEBPACK_IMPORTED_MODULE_0__.join(__dirname, "../../.erb/dll/preload.js")
        },
        width: 900,
        ...GetLeastInvisiblePosition()
    });
    MainWindow.on("show", (_Event, _IsAlwaysOnTop) => {
        MainWindow?.webContents.send("Navigate", "Main");
    });
    MainWindow.on("page-title-updated", (Event, _Title, _ExplicitSet) => {
        Event.preventDefault();
        // MainWindow?.webContents.openDevTools();
    });
    /** @TODO Find better place for this. */
    electron__WEBPACK_IMPORTED_MODULE_2__.ipcMain.on("GetAnnotatedPanels", async (_Event, ..._Arguments) => {
        const Panels = (0,_Tree__WEBPACK_IMPORTED_MODULE_6__.GetPanels)();
        const AnnotatedPanels = (await Promise.all(Panels.map(_Tree__WEBPACK_IMPORTED_MODULE_6__.AnnotatePanel)))
            .filter((Value) => {
            return Value !== undefined;
        });
        MainWindow?.webContents.send("GetAnnotatedPanels", AnnotatedPanels);
    });
    // Keyboard.Subscribe((Argument: FKeyboardEvent): void =>
    // {
    //     const InputKeys: Array<FVirtualKey> =
    //     [
    //         Vk["D"],
    //         Vk["H"],
    //         Vk["T"],
    //         Vk["N"],
    //         Vk["Z"],
    //         Vk["F"],
    //         Vk["G"],
    //         Vk["C"],
    //         Vk["R"],
    //         Vk["0"],
    //         Vk["1"],
    //         Vk["2"],
    //         Vk["3"],
    //         Vk["4"],
    //         Vk["5"],
    //         Vk["6"],
    //         Vk["7"],
    //         Vk["8"],
    //         Vk["9"]
    //     ];
    //     if (InputKeys.includes(Argument.VkCode) && Argument.State === "Up")
    //     {
    //         Log(`Logging input here as ${ Argument.VkCode }.`);
    //         MainWindow?.webContents.sendInputEvent({keyCode: KeyIdsById[Argument.VkCode], type: "keyDown"});
    //         MainWindow?.webContents.sendInputEvent({keyCode: KeyIdsById[Argument.VkCode], type: "char"});
    //         MainWindow?.webContents.sendInputEvent({keyCode: KeyIdsById[Argument.VkCode], type: "keyUp"});
    //     }
    // });
    /** @TODO Find better place for this. */
    electron__WEBPACK_IMPORTED_MODULE_2__.ipcMain.on("GetPanelScreenshots", async (_Event, ..._Arguments) => {
        const Panels = (0,_Tree__WEBPACK_IMPORTED_MODULE_6__.GetPanels)();
        const Screenshots = (await Promise.all(Panels.map(_Tree__WEBPACK_IMPORTED_MODULE_6__.GetPanelScreenshot)))
            .filter((Value) => {
            return Value !== undefined;
        });
        MainWindow?.webContents.send("GetPanelScreenshots", Screenshots);
    });
    electron__WEBPACK_IMPORTED_MODULE_2__.ipcMain.on("BringIntoPanel", async (_Event, ...Arguments) => {
        // Log("BringIntoPanel", Arguments[0]);
        console.log("BringIntoPanel !! !!", ...Arguments);
        (0,_Tree__WEBPACK_IMPORTED_MODULE_6__.BringIntoPanel)(Arguments[0]);
    });
    electron__WEBPACK_IMPORTED_MODULE_2__.ipcMain.on("Log", async (_Event, ...Arguments) => {
        const StringifiedArguments = Arguments
            .map((Argument) => {
            return typeof Argument === "string"
                ? Argument
                : JSON.stringify(Argument);
        })
            .join();
        const Birdie = chalk__WEBPACK_IMPORTED_MODULE_7___default().bgMagenta(" ⚛️ ") + " ";
        let OutString = Birdie;
        for (let Index = 0; Index < StringifiedArguments.length; Index++) {
            const Character = StringifiedArguments[Index];
            if (Character === "\n" && Index !== StringifiedArguments.length - 1) {
                OutString += Birdie + Character;
            }
            else {
                OutString += Character;
            }
        }
        console.log(OutString);
    });
    MainWindow.loadURL((0,_Core_Utility__WEBPACK_IMPORTED_MODULE_4__.ResolveHtmlPath)("index.html"));
};
function OnKey(Event) {
    const { State, VkCode } = Event;
    if (MainWindow === undefined) {
        return;
    }
    /** @TODO Make this a modifiable setting. */
    const ActivationKey = _Domain_Common_Component_Keyboard_Keyboard__WEBPACK_IMPORTED_MODULE_5__.Vk["+"];
    if (VkCode === ActivationKey) {
        if (State === "Down") {
            if ((0,_sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1__.GetWindowTitle)((0,_sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1__.GetFocusedWindow)()) !== "SorrellWm Main Window") {
                const IsTiled = (0,_Tree__WEBPACK_IMPORTED_MODULE_6__.IsWindowTiled)((0,_sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1__.GetFocusedWindow)());
                (0,_Development__WEBPACK_IMPORTED_MODULE_8__.Log)(`Focused Window of IsTiled call is ${(0,_sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1__.GetWindowTitle)((0,_sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1__.GetFocusedWindow)())}.`);
                MainWindow.webContents.send("Navigate", "", { IsTiled });
                (0,_sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1__.BlurBackground)();
            }
        }
        else {
            (0,_sorrellwm_windows__WEBPACK_IMPORTED_MODULE_1__.UnblurBackground)();
        }
    }
    else {
        MainWindow.webContents.send("Keyboard", Event);
    }
}
electron__WEBPACK_IMPORTED_MODULE_2__.app.whenReady()
    .then(LaunchMainWindow)
    .catch(console.log);
_Keyboard__WEBPACK_IMPORTED_MODULE_3__.Keyboard.Subscribe(OnKey);


/***/ })

};
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU291cmNlX01haW5fTWFpbldpbmRvd190cy5idW5kbGUuZGV2LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7O0dBR0c7QUFHMEI7QUFPb0I7QUFDYztBQUd6QjtBQUNXO0FBQzRCO0FBQ21DO0FBQ3RGO0FBQ1U7QUFHcEMsSUFBSSxVQUFVLEdBQThCLFNBQVMsQ0FBQztBQUV0RCxNQUFNLHlCQUF5QixHQUFHLEdBQTZCLEVBQUU7SUFFN0QsTUFBTSxRQUFRLEdBQTRCLDRDQUFNLENBQUMsY0FBYyxFQUFFLENBQUM7SUFHbEUsTUFBTSxhQUFhLEdBQTBCLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUF5QixFQUFrQixFQUFFO1FBRXBHLE9BQU87WUFDSCxNQUFNLEVBQUUsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNO1lBQ2hELElBQUksRUFBRSxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDdEIsS0FBSyxFQUFFLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSztZQUM5QyxHQUFHLEVBQUUsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ3hCLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztJQUVILGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFpQixFQUFFLENBQWlCLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUUvRixNQUFNLFFBQVEsR0FBVyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQXNCLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ2xHLE1BQU0sU0FBUyxHQUFXLElBQUks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O1FBQ0csSUFBSSxLQUFLLEtBQUssTUFBTSxFQUNwQixDQUFDO1lBQ0csSUFBSSxrRUFBYyxDQUFDLG9FQUFnQixFQUFFLENBQUMsS0FBSyx1QkFBdUIsRUFDbEUsQ0FBQztnQkFDRyxNQUFNLE9BQU8sR0FBWSxvREFBYSxDQUFDLG9FQUFnQixFQUFFLENBQUMsQ0FBQztnQkFDM0QsaURBQUcsQ0FBQyxxQ0FBc0Msa0VBQWMsQ0FBQyxvRUFBZ0IsRUFBRSxDQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUNsRixVQUFVLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztnQkFDekQsa0VBQWMsRUFBRSxDQUFDO1lBQ3JCLENBQUM7UUFDTCxDQUFDO2FBRUQsQ0FBQztZQUNHLG9FQUFnQixFQUFFLENBQUM7UUFDdkIsQ0FBQztJQUNMLENBQUM7U0FFRCxDQUFDO1FBQ0csVUFBVSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ25ELENBQUM7QUFDTCxDQUFDO0FBRUQseUNBQUcsQ0FBQyxTQUFTLEVBQUU7S0FDVixJQUFJLENBQUMsZ0JBQWdCLENBQUM7S0FDdEIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUV4QiwrQ0FBUSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL1NvcnJlbGxXbS8uL1NvdXJjZS9NYWluL01haW5XaW5kb3cudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogRmlsZTogICAgTWFpbldpbmRvdy50c1xuICogQXV0aG9yOiAgR2FnZSBTb3JyZWxsIDxnYWdlQHNvcnJlbGwuc2g+XG4gKiBMaWNlbnNlOiBNSVRcbiAqL1xuXG5pbXBvcnQgKiBhcyBGcyBmcm9tIFwiZnNcIjtcbmltcG9ydCAqIGFzIFBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7XG4gICAgQmx1ckJhY2tncm91bmQsXG4gICAgQ2FwdHVyZVNjcmVlblNlY3Rpb25Ub1RlbXBQbmdGaWxlLFxuICAgIHR5cGUgRkJveCxcbiAgICBHZXRGb2N1c2VkV2luZG93LFxuICAgIEdldFdpbmRvd1RpdGxlLFxuICAgIFVuYmx1ckJhY2tncm91bmQgfSBmcm9tIFwiQHNvcnJlbGx3bS93aW5kb3dzXCI7XG5pbXBvcnQgeyBCcm93c2VyV2luZG93LCBhcHAsIGlwY01haW4sIHNjcmVlbiB9IGZyb20gXCJlbGVjdHJvblwiO1xuaW1wb3J0IHR5cGUgeyBGS2V5Ym9hcmRFdmVudCB9IGZyb20gXCIuL0tleWJvYXJkLlR5cGVzXCI7XG5pbXBvcnQgdHlwZSB7IEZWaXJ0dWFsS2V5IH0gZnJvbSBcIkAvRG9tYWluL0NvbW1vbi9Db21wb25lbnQvS2V5Ym9hcmQvS2V5Ym9hcmQuVHlwZXNcIjtcbmltcG9ydCB7IEtleWJvYXJkIH0gZnJvbSBcIi4vS2V5Ym9hcmRcIjtcbmltcG9ydCB7IFJlc29sdmVIdG1sUGF0aCB9IGZyb20gXCIuL0NvcmUvVXRpbGl0eVwiO1xuaW1wb3J0IHsgS2V5SWRzQnlJZCwgVmsgfSBmcm9tIFwiQC9Eb21haW4vQ29tbW9uL0NvbXBvbmVudC9LZXlib2FyZC9LZXlib2FyZFwiO1xuaW1wb3J0IHsgQW5ub3RhdGVQYW5lbCwgQnJpbmdJbnRvUGFuZWwsIEdldEZvcmVzdCwgR2V0UGFuZWxzLCBHZXRQYW5lbFNjcmVlbnNob3QsIElzV2luZG93VGlsZWQgfSBmcm9tIFwiLi9UcmVlXCI7XG5pbXBvcnQgY2hhbGsgZnJvbSBcImNoYWxrXCI7XG5pbXBvcnQgeyBMb2cgfSBmcm9tIFwiLi9EZXZlbG9wbWVudFwiO1xuaW1wb3J0IHR5cGUgeyBGQW5ub3RhdGVkUGFuZWwsIEZQYW5lbCB9IGZyb20gXCIuL1RyZWUuVHlwZXNcIjtcblxubGV0IE1haW5XaW5kb3c6IEJyb3dzZXJXaW5kb3cgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG5cbmNvbnN0IEdldExlYXN0SW52aXNpYmxlUG9zaXRpb24gPSAoKTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9ID0+XG57XG4gICAgY29uc3QgRGlzcGxheXM6IEFycmF5PEVsZWN0cm9uLkRpc3BsYXk+ID0gc2NyZWVuLmdldEFsbERpc3BsYXlzKCk7XG5cbiAgICB0eXBlIEZNb25pdG9yQm91bmRzID0geyBsZWZ0OiBudW1iZXI7IHJpZ2h0OiBudW1iZXI7IHRvcDogbnVtYmVyOyBib3R0b206IG51bWJlciB9O1xuICAgIGNvbnN0IE1vbml0b3JCb3VuZHM6IEFycmF5PEZNb25pdG9yQm91bmRzPiA9IERpc3BsYXlzLm1hcCgoZGlzcGxheTogRWxlY3Ryb24uRGlzcGxheSk6IEZNb25pdG9yQm91bmRzID0+XG4gICAge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYm90dG9tOiBkaXNwbGF5LmJvdW5kcy55ICsgZGlzcGxheS5ib3VuZHMuaGVpZ2h0LFxuICAgICAgICAgICAgbGVmdDogZGlzcGxheS5ib3VuZHMueCxcbiAgICAgICAgICAgIHJpZ2h0OiBkaXNwbGF5LmJvdW5kcy54ICsgZGlzcGxheS5ib3VuZHMud2lkdGgsXG4gICAgICAgICAgICB0b3A6IGRpc3BsYXkuYm91bmRzLnlcbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIE1vbml0b3JCb3VuZHMuc29ydCgoQTogRk1vbml0b3JCb3VuZHMsIEI6IEZNb25pdG9yQm91bmRzKSA9PiBBLmxlZnQgLSBCLmxlZnQgfHwgQS50b3AgLSBCLnRvcCk7XG5cbiAgICBjb25zdCBNYXhSaWdodDogbnVtYmVyID0gTWF0aC5tYXgoLi4uTW9uaXRvckJvdW5kcy5tYXAoKGJvdW5kczogRk1vbml0b3JCb3VuZHMpID0+IGJvdW5kcy5yaWdodCkpO1xuICAgIGNvbnN0IE1heEJvdHRvbTogbnVtYmVyID0gTWF0aC5tYXgoLi4uTW9uaXRvckJvdW5kcy5tYXAoKGJvdW5kczogRk1vbml0b3JCb3VuZHMpID0+IGJvdW5kcy5ib3R0b20pKTtcblxuICAgIGNvbnN0IEludmlzaWJsZVg6IG51bWJlciA9IChNYXhSaWdodCArIDEpICogMjtcbiAgICBjb25zdCBJbnZpc2libGVZOiBudW1iZXIgPSAoTWF4Qm90dG9tICsgMSkgKiAyO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgeDogSW52aXNpYmxlWCxcbiAgICAgICAgeTogSW52aXNpYmxlWVxuICAgIH07XG59O1xuXG5jb25zdCBMYXVuY2hNYWluV2luZG93ID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT5cbntcbiAgICBjb25zb2xlLmxvZyhcIkxhdW5jaGluZyBtYWluIHdpbmRvdy5cIik7XG4gICAgTWFpbldpbmRvdyA9IG5ldyBCcm93c2VyV2luZG93KHtcbiAgICAgICAgYWx3YXlzT25Ub3A6IHRydWUsXG4gICAgICAgIGZyYW1lOiBmYWxzZSxcbiAgICAgICAgaGVpZ2h0OiA5MDAsXG4gICAgICAgIHNob3c6IHRydWUsXG4gICAgICAgIHNraXBUYXNrYmFyOiB0cnVlLFxuICAgICAgICB0aXRsZTogXCJTb3JyZWxsV20gTWFpbiBXaW5kb3dcIixcbiAgICAgICAgdGl0bGVCYXJTdHlsZTogXCJoaWRkZW5cIixcbiAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICAgIHdlYlByZWZlcmVuY2VzOlxuICAgICAgICB7XG4gICAgICAgICAgICBkZXZUb29sczogZmFsc2UsXG4gICAgICAgICAgICAvLyBkZXZUb29sczogdHJ1ZSxcbiAgICAgICAgICAgIG5vZGVJbnRlZ3JhdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgIHByZWxvYWQ6IGFwcC5pc1BhY2thZ2VkXG4gICAgICAgICAgICAgICAgPyBQYXRoLmpvaW4oX19kaXJuYW1lLCBcIlByZWxvYWQuanNcIilcbiAgICAgICAgICAgICAgICA6IFBhdGguam9pbihfX2Rpcm5hbWUsIFwiLi4vLi4vLmVyYi9kbGwvcHJlbG9hZC5qc1wiKVxuICAgICAgICB9LFxuICAgICAgICB3aWR0aDogOTAwLFxuICAgICAgICAuLi5HZXRMZWFzdEludmlzaWJsZVBvc2l0aW9uKClcbiAgICB9KTtcblxuICAgIE1haW5XaW5kb3cub24oXCJzaG93XCIsIChfRXZlbnQ6IEVsZWN0cm9uLkV2ZW50LCBfSXNBbHdheXNPblRvcDogYm9vbGVhbik6IHZvaWQgPT5cbiAgICB7XG4gICAgICAgIE1haW5XaW5kb3c/LndlYkNvbnRlbnRzLnNlbmQoXCJOYXZpZ2F0ZVwiLCBcIk1haW5cIik7XG4gICAgfSk7XG5cbiAgICBNYWluV2luZG93Lm9uKFxuICAgICAgICBcInBhZ2UtdGl0bGUtdXBkYXRlZFwiLFxuICAgICAgICAoRXZlbnQ6IEVsZWN0cm9uLkV2ZW50LCBfVGl0bGU6IHN0cmluZywgX0V4cGxpY2l0U2V0OiBib29sZWFuKTogdm9pZCA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgLy8gTWFpbldpbmRvdz8ud2ViQ29udGVudHMub3BlbkRldlRvb2xzKCk7XG4gICAgICAgIH1cbiAgICApO1xuXG4gICAgLyoqIEBUT0RPIEZpbmQgYmV0dGVyIHBsYWNlIGZvciB0aGlzLiAqL1xuICAgIGlwY01haW4ub24oXCJHZXRBbm5vdGF0ZWRQYW5lbHNcIiwgYXN5bmMgKF9FdmVudDogRWxlY3Ryb24uRXZlbnQsIC4uLl9Bcmd1bWVudHM6IEFycmF5PHVua25vd24+KSA9PlxuICAgIHtcbiAgICAgICAgY29uc3QgUGFuZWxzOiBBcnJheTxGUGFuZWw+ID0gR2V0UGFuZWxzKCk7XG4gICAgICAgIGNvbnN0IEFubm90YXRlZFBhbmVsczogQXJyYXk8RkFubm90YXRlZFBhbmVsPiA9IChhd2FpdCBQcm9taXNlLmFsbChQYW5lbHMubWFwKEFubm90YXRlUGFuZWwpKSlcbiAgICAgICAgICAgIC5maWx0ZXIoKFZhbHVlOiBGQW5ub3RhdGVkUGFuZWwgfCB1bmRlZmluZWQpOiBib29sZWFuID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFZhbHVlICE9PSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9KSBhcyBBcnJheTxGQW5ub3RhdGVkUGFuZWw+O1xuXG4gICAgICAgIE1haW5XaW5kb3c/LndlYkNvbnRlbnRzLnNlbmQoXCJHZXRBbm5vdGF0ZWRQYW5lbHNcIiwgQW5ub3RhdGVkUGFuZWxzKTtcbiAgICB9KTtcblxuICAgIC8vIEtleWJvYXJkLlN1YnNjcmliZSgoQXJndW1lbnQ6IEZLZXlib2FyZEV2ZW50KTogdm9pZCA9PlxuICAgIC8vIHtcbiAgICAvLyAgICAgY29uc3QgSW5wdXRLZXlzOiBBcnJheTxGVmlydHVhbEtleT4gPVxuICAgIC8vICAgICBbXG4gICAgLy8gICAgICAgICBWa1tcIkRcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIkhcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIlRcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIk5cIl0sXG4gICAgLy8gICAgICAgICBWa1tcIlpcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIkZcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIkdcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIkNcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIlJcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjBcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjFcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjJcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjNcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjRcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjVcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjZcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjdcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjhcIl0sXG4gICAgLy8gICAgICAgICBWa1tcIjlcIl1cbiAgICAvLyAgICAgXTtcblxuICAgIC8vICAgICBpZiAoSW5wdXRLZXlzLmluY2x1ZGVzKEFyZ3VtZW50LlZrQ29kZSkgJiYgQXJndW1lbnQuU3RhdGUgPT09IFwiVXBcIilcbiAgICAvLyAgICAge1xuICAgIC8vICAgICAgICAgTG9nKGBMb2dnaW5nIGlucHV0IGhlcmUgYXMgJHsgQXJndW1lbnQuVmtDb2RlIH0uYCk7XG4gICAgLy8gICAgICAgICBNYWluV2luZG93Py53ZWJDb250ZW50cy5zZW5kSW5wdXRFdmVudCh7a2V5Q29kZTogS2V5SWRzQnlJZFtBcmd1bWVudC5Wa0NvZGVdLCB0eXBlOiBcImtleURvd25cIn0pO1xuICAgIC8vICAgICAgICAgTWFpbldpbmRvdz8ud2ViQ29udGVudHMuc2VuZElucHV0RXZlbnQoe2tleUNvZGU6IEtleUlkc0J5SWRbQXJndW1lbnQuVmtDb2RlXSwgdHlwZTogXCJjaGFyXCJ9KTtcbiAgICAvLyAgICAgICAgIE1haW5XaW5kb3c/LndlYkNvbnRlbnRzLnNlbmRJbnB1dEV2ZW50KHtrZXlDb2RlOiBLZXlJZHNCeUlkW0FyZ3VtZW50LlZrQ29kZV0sIHR5cGU6IFwia2V5VXBcIn0pO1xuICAgIC8vICAgICB9XG4gICAgLy8gfSk7XG5cbiAgICAvKiogQFRPRE8gRmluZCBiZXR0ZXIgcGxhY2UgZm9yIHRoaXMuICovXG4gICAgaXBjTWFpbi5vbihcIkdldFBhbmVsU2NyZWVuc2hvdHNcIiwgYXN5bmMgKF9FdmVudDogRWxlY3Ryb24uRXZlbnQsIC4uLl9Bcmd1bWVudHM6IEFycmF5PHVua25vd24+KSA9PlxuICAgIHtcbiAgICAgICAgY29uc3QgUGFuZWxzOiBBcnJheTxGUGFuZWw+ID0gR2V0UGFuZWxzKCk7XG4gICAgICAgIGNvbnN0IFNjcmVlbnNob3RzOiBBcnJheTxzdHJpbmc+ID0gKGF3YWl0IFByb21pc2UuYWxsKFBhbmVscy5tYXAoR2V0UGFuZWxTY3JlZW5zaG90KSkpXG4gICAgICAgICAgICAuZmlsdGVyKChWYWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkKTogYm9vbGVhbiA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiBWYWx1ZSAhPT0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfSkgYXMgQXJyYXk8c3RyaW5nPjtcblxuICAgICAgICBNYWluV2luZG93Py53ZWJDb250ZW50cy5zZW5kKFwiR2V0UGFuZWxTY3JlZW5zaG90c1wiLCBTY3JlZW5zaG90cyk7XG4gICAgfSk7XG5cbiAgICBpcGNNYWluLm9uKFwiQnJpbmdJbnRvUGFuZWxcIiwgYXN5bmMgKF9FdmVudDogRWxlY3Ryb24uRXZlbnQsIC4uLkFyZ3VtZW50czogQXJyYXk8dW5rbm93bj4pID0+XG4gICAge1xuICAgICAgICAvLyBMb2coXCJCcmluZ0ludG9QYW5lbFwiLCBBcmd1bWVudHNbMF0pO1xuICAgICAgICBjb25zb2xlLmxvZyhcIkJyaW5nSW50b1BhbmVsICEhICEhXCIsIC4uLkFyZ3VtZW50cyk7XG4gICAgICAgIEJyaW5nSW50b1BhbmVsKEFyZ3VtZW50c1swXSBhcyBGQW5ub3RhdGVkUGFuZWwpO1xuICAgIH0pO1xuXG4gICAgaXBjTWFpbi5vbihcIkxvZ1wiLCBhc3luYyAoX0V2ZW50OiBFbGVjdHJvbi5FdmVudCwgLi4uQXJndW1lbnRzOiBBcnJheTx1bmtub3duPikgPT5cbiAgICB7XG4gICAgICAgIGNvbnN0IFN0cmluZ2lmaWVkQXJndW1lbnRzOiBzdHJpbmcgPSBBcmd1bWVudHNcbiAgICAgICAgICAgIC5tYXAoKEFyZ3VtZW50OiB1bmtub3duKTogc3RyaW5nID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBBcmd1bWVudCA9PT0gXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICA/IEFyZ3VtZW50XG4gICAgICAgICAgICAgICAgICAgIDogSlNPTi5zdHJpbmdpZnkoQXJndW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKCk7XG5cbiAgICAgICAgY29uc3QgQmlyZGllOiBzdHJpbmcgPSBjaGFsay5iZ01hZ2VudGEoXCIg4pqb77iPIFwiKSArIFwiIFwiO1xuICAgICAgICBsZXQgT3V0U3RyaW5nOiBzdHJpbmcgPSBCaXJkaWU7XG4gICAgICAgIGZvciAobGV0IEluZGV4OiBudW1iZXIgPSAwOyBJbmRleCA8IFN0cmluZ2lmaWVkQXJndW1lbnRzLmxlbmd0aDsgSW5kZXgrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgQ2hhcmFjdGVyOiBzdHJpbmcgPSBTdHJpbmdpZmllZEFyZ3VtZW50c1tJbmRleF07XG4gICAgICAgICAgICBpZiAoQ2hhcmFjdGVyID09PSBcIlxcblwiICYmIEluZGV4ICE9PSBTdHJpbmdpZmllZEFyZ3VtZW50cy5sZW5ndGggLSAxKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIE91dFN0cmluZyArPSBCaXJkaWUgKyBDaGFyYWN0ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgT3V0U3RyaW5nICs9IENoYXJhY3RlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKE91dFN0cmluZyk7XG4gICAgfSk7XG5cbiAgICBNYWluV2luZG93LmxvYWRVUkwoUmVzb2x2ZUh0bWxQYXRoKFwiaW5kZXguaHRtbFwiKSk7XG59O1xuXG5mdW5jdGlvbiBPbktleShFdmVudDogRktleWJvYXJkRXZlbnQpOiB2b2lkXG57XG4gICAgY29uc3QgeyBTdGF0ZSwgVmtDb2RlIH0gPSBFdmVudDtcbiAgICBpZiAoTWFpbldpbmRvdyA9PT0gdW5kZWZpbmVkKVxuICAgIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8qKiBAVE9ETyBNYWtlIHRoaXMgYSBtb2RpZmlhYmxlIHNldHRpbmcuICovXG4gICAgY29uc3QgQWN0aXZhdGlvbktleTogRlZpcnR1YWxLZXkgPSBWa1tcIitcIl07XG5cbiAgICBpZiAoVmtDb2RlID09PSBBY3RpdmF0aW9uS2V5KVxuICAgIHtcbiAgICAgICAgaWYgKFN0YXRlID09PSBcIkRvd25cIilcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKEdldFdpbmRvd1RpdGxlKEdldEZvY3VzZWRXaW5kb3coKSkgIT09IFwiU29ycmVsbFdtIE1haW4gV2luZG93XCIpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgSXNUaWxlZDogYm9vbGVhbiA9IElzV2luZG93VGlsZWQoR2V0Rm9jdXNlZFdpbmRvdygpKTtcbiAgICAgICAgICAgICAgICBMb2coYEZvY3VzZWQgV2luZG93IG9mIElzVGlsZWQgY2FsbCBpcyAkeyBHZXRXaW5kb3dUaXRsZShHZXRGb2N1c2VkV2luZG93KCkpIH0uYCk7XG4gICAgICAgICAgICAgICAgTWFpbldpbmRvdy53ZWJDb250ZW50cy5zZW5kKFwiTmF2aWdhdGVcIiwgXCJcIiwgeyBJc1RpbGVkIH0pO1xuICAgICAgICAgICAgICAgIEJsdXJCYWNrZ3JvdW5kKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBVbmJsdXJCYWNrZ3JvdW5kKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZVxuICAgIHtcbiAgICAgICAgTWFpbldpbmRvdy53ZWJDb250ZW50cy5zZW5kKFwiS2V5Ym9hcmRcIiwgRXZlbnQpO1xuICAgIH1cbn1cblxuYXBwLndoZW5SZWFkeSgpXG4gICAgLnRoZW4oTGF1bmNoTWFpbldpbmRvdylcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpO1xuXG5LZXlib2FyZC5TdWJzY3JpYmUoT25LZXkpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9